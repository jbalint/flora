; Script generated by the Inno Setup Script Wizard.
; Modified from xsb.iss
; Double click on this file to run with inno, then build-menu, compile.
; A compiled version of Flora-2 must exist at the location pointed
; by the MyBaseDir variable below.

#define MyAppName "Flora-2"
#define MyAppVerName "Flora-2 0.99.2"
#define MyAppPublisher "Flora-2"
#define MyAppURL "http://flora.sourceforge.net/"
#define MyAppUrlName "Flora-2 Web Site.url"

#define FLORA_DIR "{reg:HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment,FLORA_DIR|{pf}\Flora-2}"
#define MyBaseDir "C:\flora2"

[Setup]
AppName={#MyAppName}
AppVerName={#MyAppVerName}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
ChangesEnvironment=yes
DefaultDirName={#FLORA_DIR}
DefaultGroupName={#MyAppName}
DisableProgramGroupPage=yes
LicenseFile={#MyBaseDir}\LICENSE
InfoBeforeFile={#MyBaseDir}\README
OutputBaseFilename=flora2-0.99.2
Compression=lzma
SolidCompression=yes
PrivilegesRequired=none

VersionInfoVersion=0.99.2
VersionInfoCopyright=© The Research Foundation of SUNY, 1999 - 2013

AllowRootDirectory=yes
UninstallFilesDir="{userdocs}\Flora-2 uninstaller"

MinVersion=0,5.1

[Types]
Name: "full"; Description: "Full Flora-2 installation (recommended)"
Name: "base"; Description: "Base Flora-2 installation"

[Components]
Name: "base"; Description: "Base system"; Types: full base; Flags: disablenouninstallwarning
Name: "base\sources"; Description: "Base system plus Prolog source files"; Types: full base; Flags: disablenouninstallwarning
Name: "documentation"; Description: "Documentation"; Types: full; Flags: disablenouninstallwarning

[Tasks]
Name: website; Description: "&Visit {#MyAppName} web site"; Components: base
Name: shortcut; Description: "&Create a desktop shortcut to the Flora-2 folder"; Components: base

[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"

[Messages]
BeveledLabel=Flora-2 0.99.2 © The Research Foundation of SUNY, 1999 - 2013

[Dirs]
Name: "{userdocs}\Flora-2 uninstaller"

[Files]
Source: "{#MyBaseDir}\*.xwam"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\floraconfig.bat"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\runflora.bat"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\etc\flora.ico"; Excludes: ".*,CVS"; DestDir: "{app}\etc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\*.H"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\makeflora.bat"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\AT\*.flr"; Excludes: ".*,CVS"; DestDir: "{app}\AT"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\AT\include\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\AT\include"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\AT\prolog\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\AT\prolog"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\AT\prolog\*.xwam"; Excludes: ".*,CVS"; DestDir: "{app}\AT\prolog"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\AT\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\AT"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\closure\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\closure"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\closure\*.fli"; Excludes: ".*,CVS"; DestDir: "{app}\closure"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\closure\*.inc"; Excludes: ".*,CVS"; DestDir: "{app}\closure"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\closure\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\closure"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\datatypes\*.xwam"; Excludes: ".*,CVS"; DestDir: "{app}\datatypes"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\datatypes\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\datatypes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\datatypes\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\datatypes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\debugger\*.xwam"; Excludes: ".*,CVS"; DestDir: "{app}\debugger"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\debugger\*.dat"; Excludes: ".*,CVS"; DestDir: "{app}\debugger"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\debugger\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\debugger"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\debugger\*.in"; Excludes: ".*,CVS"; DestDir: "{app}\debugger"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\debugger\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\debugger"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\demos\*.flr"; Excludes: ".*,CVS"; DestDir: "{app}\demos"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\demos\sgml\*.flr"; Excludes: ".*,CVS"; DestDir: "{app}\demos\sgml"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\demos\xpath\*.flr"; Excludes: ".*,CVS"; DestDir: "{app}\demos\xpath"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\demos\sgml\expectedoutput"; Excludes: ".*,CVS"; DestDir: "{app}\demos\expectedoutput"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\demos\xpath\expectedoutput"; Excludes: ".*,CVS"; DestDir: "{app}\xpath\expectedoutput"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\demos\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\demos"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\docs\*.pdf"; Excludes: ".*,CVS"; DestDir: "{app}\docs"; Components: documentation; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\docs\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\docs"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\emacs\*.el"; Excludes: ".*,CVS"; DestDir: "{app}\emacs"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\emacs\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\emacs"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\emacs\README"; Excludes: ".*,CVS"; DestDir: "{app}\emacs"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\flrincludes\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\flrincludes"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\genincludes\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\genincludes"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\genincludes\*.fli"; Excludes: ".*,CVS"; DestDir: "{app}\genincludes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\genincludes\*.inc"; Excludes: ".*,CVS"; DestDir: "{app}\genincludes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\genincludes\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\genincludes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\headerinc\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\headerinc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\includes\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\includes"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\includes\*.fli"; Excludes: ".*,CVS"; DestDir: "{app}\includes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\includes\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\includes"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\lib\*.flr"; Excludes: ".*,CVS"; DestDir: "{app}\lib"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\lib\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\lib"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\lib\include\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\lib"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\libinc\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\libinc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs


Source: "{#MyBaseDir}\cc\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\cc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\prolog2hilog.*"; Excludes: ".*,CVS"; DestDir: "{app}\cc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\flora_ground.*"; Excludes: ".*,CVS"; DestDir: "{app}\cc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\cc"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\NMakefile64.mak"; Excludes: ".*,CVS"; DestDir: "{app}\cc"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\windows\*.dll"; Excludes: ".*,CVS"; DestDir: "{app}\cc\windows"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\windows\*.exp"; Excludes: ".*,CVS"; DestDir: "{app}\cc\windows"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\windows\*.lib"; Excludes: ".*,CVS"; DestDir: "{app}\cc\windows"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\windows64\*.dll"; Excludes: ".*,CVS"; DestDir: "{app}\cc\windows64"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\windows64\*.exp"; Excludes: ".*,CVS"; DestDir: "{app}\cc\windows64"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\cc\windows64\*.lib"; Excludes: ".*,CVS"; DestDir: "{app}\cc\windows64"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\pkgs\*.flr"; Excludes: ".*,CVS"; DestDir: "{app}\pkgs"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\pkgs\include\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\pkgs\include"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\pkgs\prolog\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\pkgs\prolog"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\pkgs\prolog\*.xwam"; Excludes: ".*,CVS"; DestDir: "{app}\pkgs\prolog"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\pkgs\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\pkgs"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\syslib\*.xwam"; Excludes: ".*,CVS"; DestDir: "{app}\syslib"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\syslib\*.P"; Excludes: ".*,CVS"; DestDir: "{app}\syslib"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\syslib\*.H"; Excludes: ".*,CVS"; DestDir: "{app}\syslib"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "{#MyBaseDir}\syslib\NMakefile.mak"; Excludes: ".*,CVS"; DestDir: "{app}\syslib"; Components: base\sources; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\syslibinc\*.flh"; Excludes: ".*,CVS"; DestDir: "{app}\syslibinc"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

Source: "{#MyBaseDir}\java"; Excludes: ".*,CVS"; DestDir: "{app}\java"; Components: base; Flags: ignoreversion recursesubdirs createallsubdirs

[INI]
Filename: "{app}\{#MyAppUrlName}"; Section: "InternetShortcut"; Key: "URL"; String: "{#MyAppURL}"; Components: base


[Icons]
Name: "{group}\Flora-2"; Filename: "{app}\runflora.bat"; Parameters: ""; Comment: "Runs Flora-2 within a command shell"; WorkingDir: "{userdocs}"; Components: base; Flags: createonlyiffileexists IconFilename: "{app}\etc\flora.ico"

Name: "{group}\License"; Filename: "{app}\LICENSE"; Components: base

Name: "{group}\{cm:UninstallProgram,{#MyAppName}}"; Filename: "{uninstallexe}"; Components: base

Name: "{userdesktop}\Flora-2"; Filename: "{app}"; Components: base; Tasks: shortcut

Name: "{group}\Web Site"; Filename: "{#MyAppUrl}"; Components: base

[Registry]
Root: HKLM; Subkey: "SYSTEM\CurrentControlSet\Control\Session Manager\Environment"; ValueType: expandsz; ValueName: "FLORA_DIR"; ValueData: "{app}"; Components: base; Flags: deletevalue uninsdeletevalue

[Run]
Filename: "{app}\floraconfig.bat"; Parameters: {XSB_script}
Filename: "{app}\{#MyAppUrlName}"; Flags: shellexec nowait; Tasks: website

[UninstallDelete]
Type: filesandordirs; Name: "{app}"; Components: base
Type: filesandordirs; Name: "{group}"; Components: base

[Code]
var XSB_script: String;

procedure InitializeWizard();
begin
var Page: TInputDirWizardPage;

  Page := CreateInputFilePage(wpSelectDir,
    'Specify the location of the XSB invocation script.'
    'It should look like ....\XSB\bin\xsb.bat or ....\XSB\bin\xsb64.bat' +
    'depending on whether you configured a 32-bit or a 64-bit version of XSB.',
    'Use the Browse button to navigate to the script.');
  Page.Add('Location of xsb.bat or xsb64.bat: ', "*.bat", "*.bat");

  // Read value into variable
  XSB_script := Page.Values[0];
end

