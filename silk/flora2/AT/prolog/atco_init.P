/*
  ATCO: A client, like SILK, should generate a flora-addable file containing
        SILK refutablebodylit facts and bodyinfo facts.
        The file should look like this:

    #include "atco.flh"

    // for each rule and a body literal in it
    SILK_REFUTABLEBODYLIT(ruleid,${head},_@,${bodylit1}).
    SILK_REFUTABLEBODYLIT(ruleid,${head},_@,${bodylit2}).
    ... ... ...
    ... ... ...
    // for each rule
    SILK_BODYINFO(ruleid,head,_@,?_ExtLit,?_CtlVar,bodyspec)
    ... ... ...

    where ruleid is the rule id, head is the head of that rule
      _@, ?_ExtLit, ?_CtlVar  are to be reproduced literally.
      bodyspec:
	is a reified rule ``body'' generated by the omni transform AND
	modified as follows:
	- irrefutable literals in ``body'' are left as is in ``bodyspec''
	- if ``blt'' is a refutable literal in ``body'' then ``bodyspec''
	   has this in its place:
	     ${SILK_ATCO_REFUTABLE_WRAP(?_CtlVar,?_ExtLit,_@,${blt})}
	  The literals in bodyspec must appear insice paretheses
	  and separated with commas. For example:

   SILK_BODYINFO(ex3_r11, ${ex3_p}, _@, ?_ExtLit, ?_CtlVar,
                 (${SILK_ATCO_REFUTABLE_WRAP(?_CtlVar,?_ExtLit,${ex3_a})},
                  ${SILK_ATCO_REFUTABLE_WRAP(?_CtlVar,?_ExtLit,_@,${ex3_b})})).

    *** It is NOT necessary to generate SILK_BODYINFO for rules with no
        refutable bodylits. Better not to to save memory and load time.

    *** It is NOT necessary to generate irrefutable bodylits. They are not
        going to be used.

    Loading in SILK:
        If the main KB is foo.flr then it should generate something like
        foo_atco.flr with the above statements. The whole thing is loaded
        like this:

        ?- [atco_init, +foo_atco >> some_module].

        Then load foo.flr either statically or dynamically (using _add)
        into the same module, e.g.,

	?- [foo >> some_module].
*/

:- compiler_options([xpp_on]).

#include "atco_common.flh"

?- dynamic SILK_REFUTABLEBODYLIT/4,
           %%SILK_IRREFUTABLEBODYLIT/4,
           SILK_BODYINFO/6.

?- index(SILK_REFUTABLEBODYLIT/4, [1,2]),
    %%index(SILK_IRREFUTABLEBODYLIT/3, [1,2]),
    index(SILK_BODYINFO/6, [1,2]).

%% this is the only important declaration here. the others (above)
%% are duplicates, for documentation
?- flrprolog:flora_define_permanent_prolog(SILK_REFUTABLEBODYLIT,4),
   %%flrprolog:flora_define_permanent_prolog(SILK_IRREFUTABLEBODYLIT,4),
   flrprolog:flora_define_permanent_prolog(SILK_BODYINFO,6).

