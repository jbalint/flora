/*
  ATCO: A client, like SILK, should generate a flora-addable file containing
        SILK refutablebodylit facts and bodyinfo facts.
        The file should look like this:

    #include "atco.flh"

    // for each rule and a body literal in it
    SILK_REFUTABLEBODYLIT(ruleid,${head},_@,${bodylit1}).
    SILK_REFUTABLEBODYLIT(ruleid,${head},_@,${bodylit2}).
    ... ... ...
    ... ... ...
    // for each rule
    SILK_BODYINFO(ruleid,head,_@,?_ExtLit,?_CtlVar,bodyspec)
    ... ... ...

    where ruleid is the rule id, head is the head of that rule
      _@, ?_ExtLit, ?_CtlVar  are to be reproduced literally.
      bodyspec:
	is a reified rule ``body'' generated by the omni transform AND
	modified as follows:
	- irrefutable literals in ``body'' are left AS IS in ``bodyspec''
	  (reified).
	- if ``blt'' is a refutable literal in ``body'' then ``bodyspec''
	   has this in its place:
	     ATCO_BODYLIT_WRAPPER(?_CtlVar,?_ExtLit,_@,${blt})
	  The literals in bodyspec must appear inside paretheses
	  and separated with commas. For example:

   SILK_BODYINFO(ex3_r11, ${ex3_p}, _@, ?_ExtLit, ?_CtlVar,
                 (ATCO_BODYLIT_WRAPPER(?_CtlVar,?_ExtLit,${ex3_a}),
		  ${some_irrefutable_body_lit1},
                  ATCO_BODYLIT_WRAPPER(?_CtlVar,?_ExtLit,_@,${ex3_b}),
		  ${some_irrefutable_body_lit2})).

    *** It is NOT necessary to generate SILK_BODYINFO for rules with no
        refutable bodylits. Better not to so as to save memory and load time.

    *** It is NOT necessary to generate irrefutable bodylits: they are not used.

    Loading in SILK:
        If the main KB is foo.silk then it should generate something like
        foo_atco_aux.flr with the above statements. The whole thing is loaded
        like this:

        ?- [atco_init].

        Then load the FLORA file(s) foo.flr obtained from foo.silk.
        That file should have something like

	:- use_argumentation_theory{SILK_AT}.
        ?- [atco2>>SILK_AT].

        at the top.

        The file foo.flr can be loaded either statically (using _load)
	or dynamically (using _add), and both foo.flr and foo_atco_aux.flr
	should be loaded into the same module:

	?- [foo >> some_module].

        Load the auxiliary metafacts generated from the rules in foo.silk.

        ?- [+foo_atco_aux >> same_module_as_foo.flr].

        Please remember that Polina has sent her mods for modules and
	untabled preds to Mike, so loading into modules is coming very
	soon. In particular, please avoid using the module 'main' explicitly.
*/

:- compiler_options([xpp_on]).

#include "atco_common.flh"

?- dynamic SILK_REFUTABLEBODYLIT/4,
           %%SILK_IRREFUTABLEBODYLIT/4,
           SILK_BODYINFO/6.

?- index(SILK_REFUTABLEBODYLIT/4, [1,2]),
    %%index(SILK_IRREFUTABLEBODYLIT/3, [1,2]),
    index(SILK_BODYINFO/6, [1,2]).

%% this is the only important declaration here. the others (above)
%% are duplicates, for documentation
?- flrprolog:flora_define_permanent_prolog(SILK_REFUTABLEBODYLIT,4),
   flrprolog:flora_define_permanent_prolog(SILK_BODYINFO,6).

