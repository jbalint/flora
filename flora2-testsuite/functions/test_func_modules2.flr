udf foo(?x):=?y if pred(?x,?y)@bar.
p(b).
p(g).
g(?x):-p(foo(?x)).
//g2(?x):-p(?newvar1), pred(?x,?newvar1)@bar.

%preload :- _compileadd(test_func_modulebar),[+test_func_modulebar>>bar].
%test1:- g(?x),writeln(?x)@_plg, fail.
%test1 :- true.
%test2:- pred(a,foo(a))@bar,writeln('yes')@_plg,!.
%test2:- writeln('no')@_plg.
%test3:- pred(f,foo(f))@bar,writeln('yes')@_plg,!.
%test3:- writeln('no')@_plg.

%pretest :- %preload, %test1, %test2, %test3.

%test :-
	tell(temp)@_plg,
	%pretest,
	told@_plg.
