a(abc):-u(1).
a(abc):-u(2).
u(1).
c(123):-w(1).
c(123):-w(2).
w(1).

?- insertrule{(b(cde):-v(1)),(b(cde):-v(2))}, insert{v(1)}.

%tst1 :-
	write('test1: ')@_plg,
	refresh{a(?)},
	?G = ${a(?)}, traced_call(?G,?CalledId,?F,?M)@_plg(flrcallflora),
	delete{u(1)}, insert{u(2)}, refresh{a(?)},
	traced_call(?G,?CalledId2,?F2,?M2)@_plg(flrcallflora),
	writeln(?CalledId+?CalledId2+?F+?F2+?M+?M2)@_plg.

%tst2 :-
	write('test2: ')@_plg,
	refresh{b(?)},
	?G = ${b(?)}, traced_call(?G,?CalledId,?F,?M)@_plg(flrcallflora),
	delete{v(1)}, insert{v(2)}, refresh{b(?)},
	traced_call(?G,?CalledId2,?F2,?M2)@_plg(flrcallflora),
	writeln(?CalledId+?CalledId2+?F+?F2+?M+?M2)@_plg.

%tst3 :-
	write('test3: ')@_plg,
	refresh{c(?)},
	traced_call(${c(?)},?CalledId,?F,?M)@_plg(flrcallflora),
	delete{w(1)}, insert{w(2)}, refresh{c(?)},
	traced_call(${c(?)},?CalledId2,?F2,?M2)@_plg(flrcallflora),
	writeln(?CalledId+?CalledId2+?F+?F2+?M+?M2)@_plg.

%pretest :- %tst1, %tst2, %tst3.

%test :- tell(temp)@_plg(),
	%pretest,
	Method[mustDefine(on)]@_sys,
	delete{u(2),v(2),w(2)}, insert{u(1),v(1),w(1)},
	%pretest,
	Method[mustDefine(off)]@_sys,
	told@_plg().
